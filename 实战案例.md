# 主要说明
* 案例均在anaconda上运行，主要掌握anaconda环境的概念，针对不同的练习建立对应的环境。
* 练习相关访问链接: https://pan.baidu.com/s/1-P6O09QDiRS4Vo98x9-i7w 提取码: wsvt
# 0 Pytorch基础
https://speech.ee.ntu.edu.tw/~hylee/ml/ml2021-course-data/hw/Pytorch/Pytorch_Tutorial_1.pdf
* DNN训练过程的步骤
* Tensor的概念：构造、操作符、CPU或者GPU选择、
* 如何计算梯度：反向计算
* Dataset & Dataloader装载数据，读数据和预处理，返回计算样本，数据集的大小
* torch.nn定义神经网络，定义输入，输出，线性层，权重和偏差矩阵，激活函数，损失函数，前向计算，计算输出值
* torch.optim优化神经网络，优化算法
* Neural Network Training神经网络训练
> * 读数据
> * 将数据集放到Dataloader
> * 构建模型并选择CPU或者GPU
> * 设置损失函数
> * 设置优化器
> * iterate n_epochs
> * set model to train mode
> * iterate through the dataloader
> * set gradient to zero
> * move data to device (cpu/cuda)
> * forward pass (compute output)
> * compute loss
> * compute gradient (backpropagation)
> * update model with optimizer
* Neural Network Validation神经网络验证
> * set model to evaluation mode
> * iterate through the dataloader
> * move data to device (cpu/cuda)
> * disable gradient calculation
> * forward pass (compute output)
> * compute loss
> * accumulate loss
> * compute averaged loss
* Neural Network Validation神经网络测试
> * set model to evaluation mode
> * iterate through the dataloader
> * move data to device (cpu/cuda)
> * disable gradient calculation
> * forward pass (compute output)
> * collect prediction
* Saving/Loading a Neural Network保存训练好的神经网络模型
# 1 使用深度神经网络拟合（回归）预测
## 练习案例
https://speech.ee.ntu.edu.tw/~hylee/ml/ml2021-course-data/hw/HW01/HW01.pdf
## 练习目标
* 学会使用jupyter notebook运行Python程序
* 熟悉Pytorch
* 掌握使用深度神经网络预测的方法
* 理解深度神经网络的训练方法，如调整超参数、特征选择、正则化
* 熟悉评价指标  RMSE
## 代码
* https://github.com/ga642381/ML2021-Spring/blob/main/HW01/HW01.ipynb
* 在当前环境下安装Python依赖包
`
pip install -r requirements.txt
`
* 阅读代码注释
## 主要知识
* 读数据，做预处理
* 定义网络：初始化模型，定义层数
* 激活函数
* 损失函数
* 前向计算：forward 计算结果  model(x)
* 反向计算：loss.backward()
* 保存模型
# 2 使用神经网络识别手写数字，即多分类问题
## 参考链接
* https://github.com/GoogleCloudPlatform/tensorflow-without-a-phd/blob/master/tensorflow-mnist-tutorial/
* https://github.com/pytorch/examples/tree/master/mnist
## 练习目标
* 学会用命令行运行Python程序
`
python main.py
`
* 熟悉Pytorch
* 掌握使用深度神经网络分类的方法
* 熟悉分类算法的评价指标

## 安装
### tensorflow demo
pip install tensorflow
pip install matplotlib
### pytorch demo
* 理解Pytorch特点 https://pytorch.org/
* 参考 https://speech.ee.ntu.edu.tw/~hylee/ml/ml2021-course-data/hw/Pytorch/Pytorch_Tutorial_1.pdf

## 运行方法
### tensorflow demo
使用jupyter notebook， 逐步运行
### pytorch demo
* 1. 建立程序运行环境  
可以用命令行，也可以用可视化界面建立
```
conda create --name envname
```
* 2. 安装依赖
`
pip install -r requirements.txt
`
* 3. 运行程序
`
python main.py
`
## 常见问题
# 3 对象检测
## 代码
* https://github.com/chenyuntc/simple-faster-rcnn-pytorch
* 参考学习资料  https://github.com/bubbliiiing/faster-rcnn-pytorch
## 练习目标
* 了解半监督学习的原理
* 了解半监督学习的算法
# 4 使用CNN实现多类识别 
## 代码
* 代码链接：https://github/ga642381/ML2021-Spring/blob/main/HW03/HW03.ipynb
* 参考代码：https://github.com/1am9trash/HUNG_YI_LEE_ML_2021/blob/main/hw/hw3/hw3_code.ipynb
* 说明：本代码需在 Python3.7运行，否则会有如下错误 Can't pickle <function <lambda> at 0x0000002F2175B048>: attribute lookup <lambda> on __main__ failed
* 依赖文件：https://github.com/bettermorn/IAICourse/blob/main/Code/MLSpringHW03/requirements.txt
* 代码需要调整的地方
> * 设置 os.environ['WANDB_CONSOLE'] = 'off' 否则会出现 AssertionError: can only test a child process 参考https://github.com/wandb/client/issues/1994
> * 初始化模型之前增加以下代码，以消除以下警告，参考 https://stackoverflow.com/questions/64772335/pytorch-w-parallelnative-cpp206
[W ParallelNative.cpp:206] Warning: Cannot set number of intraop threads after parallel work has started or after set_num_threads call when using native parallel backend (function set_num_threads) 
```
import os
# 装载数据的时候无法使用并行，只能使用单线程
os.environ["OMP_NUM_THREADS"] = "1"
```
亦可在构造data loader时设置 num_workers =0 
## 练习目标
1. 用卷积神经网络解决图像分类问题。
2. 用数据增强来提高性能。
3. 了解如何利用未标记的数据以及它的好处。
# 5 使用InceptionTime、MiniRocket和transformer模型分类和预测时序数据
## 代码
* https://github.com/timeseriesAI/tsai/tree/main/tutorial_nbs
* 1. 04_Intro_to_Time_Series_Regression.ipynb
* 2. 10_Time_Series_Classification_and_Regression_with_MiniRocket.ipynb
* 3. 07_Time_Series_Classification_with_Transformers.ipynb
## 练习目标
* 熟悉时序预测的方法
* 熟悉tsai的使用
# 6 自然语言处理之机器翻译，使用Seq2Seq和transformer
## 代码
* https://github.com/ga642381/ML2021-Spring/blob/main/HW05/HW05.ipynb
## 练习目标
* 理解SeqtoSeq
* 理解transformer的原理
* 熟悉训练技巧
> * 用子词单元对数据进行标记
> * 标签平滑正则化
> * 学习率调度
> * 反向翻译
## 其他参考
* 自注意力机制结合了RNN（考虑整个序列）和CNN（平行处理）的优势，学习使用transformer， https://github.com/ga642381/ML2021-Spring/blob/main/HW04/HW04.ipynb
# 7 GAN 生成对抗式网络 生成图片
* https://github.com/ga642381/ML2021-Spring/blob/main/HW06/HW06.ipynb
## 练习目标
* 理解GAN模型的原理
# 8 使用BERT实现问题回答
## 代码
* https://github.com/ga642381/ML2021-Spring/blob/main/HW07/HW07.ipynb
## 练习目标
* 理解预训练模型
* 理解Bert模型的原理
# 9 识别异常
## 代码
* https://github.com/ga642381/ML2021-Spring/blob/main/HW08/HW08.ipynb
## 练习目标
* 理解无监督学习在计算机视觉中的应用
* 理解auto-encoder原理 
> * 什么时候停止训练？训练应该在mse损失收敛时停止
> * 在推理过程中，我们计算输入图像和重建图像之间的重建误差。
> * 重构误差将被称为异常性（异常分数）。
> * 一个图像的异常性可以作为衡量它的分布在训练期间未被发现的可能性的指标
> * 使用异常度作为预测值。
* 熟悉无监督学习的评估指标 ROC_AUC score
# 10 强化学习
## 代码
* https://github.com/ga642381/ML2021-Spring/blob/main/HW12/HW12_ZH.ipynb
## 练习目标
* 理解强化学习原理
* 使用以下方法实现强化学习
> * Policy Gradient
> * Actor-Critic 
# 11 知识图谱与知识查询
## 代码
* 1. https://github.com/bettermorn/KGCourse/tree/master/Lab/elasticQA
## 练习目标
* 理解构建知识图谱的流程和原理
* 理解知识图谱所用相关人工智能技术
